webpackJsonp([17],{LpgP:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=r("Gu7T"),a=r.n(s),o=r("Dd8w"),i=r.n(o),n=r("O4Lo"),l={data:function(){return{id:null,visible:!1,rscoList:[],dataForm:{id:"",pid:"",cd:"",nm:"",rmks:"",rscoIdList:[]},dataRule:{cd:[{required:!0,message:"编码不能为空",trigger:"blur"}],nm:[{required:!0,message:"名称不能为空",trigger:"blur"}]}}},methods:{init:function(t){var e=this;this.id=t,this.visible=!0,this.rscoList=[],this.$nextTick(function(){e.$refs.dataForm.resetFields(),e.$refs.rscoListTree.setCheckedKeys([]),e.listRsco(),e.id&&e.getInfo()})},listRsco:function(){var t=this;this.$http.get("/sys/rsco/listPermRtRscoTreeNode",{params:{subId:this.id}}).then(function(e){var r=e.data;if(0!==r.code)return t.$message.error(r.msg);t.rscoList=r.data.list,t.$nextTick(function(){r.data.checkedKeys.forEach(function(e){return t.$refs.rscoListTree.setChecked(e,!0)})})}).catch(function(){})},getInfo:function(){var t=this;this.$http.get("/sys/role/info/"+this.id).then(function(e){var r=e.data;if(0!==r.code)return t.$message.error(r.msg);t.dataForm=i()({},t.dataForm,r.data)}).catch(function(){})},dataFormSubmit:r.n(n)()(function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){t.dataForm.rscoIdList=[].concat(a()(t.$refs.rscoListTree.getCheckedKeys()),a()(t.$refs.rscoListTree.getHalfCheckedKeys()));var r=t.id?"/sys/role/upd":"/sys/role/add";t.$http.post(r,i()({},t.dataForm)).then(function(e){var r=e.data;r&&0===r.code?t.$message({message:"操作成功",type:"success",duration:500,onClose:function(){t.visible=!1,t.$emit("refreshDataList")}}):t.$message.error(r.msg)})}})},1e3,{leading:!0,trailing:!1})}},c={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{staticClass:"mod-role-edit",attrs:{title:t.id?"修改":"新增","close-on-click-modal":!1,visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[r("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataRule,"label-width":"120px"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.dataFormSubmit()}}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:20}},[r("el-form-item",{attrs:{label:"编码",prop:"cd"}},[r("el-input",{attrs:{placeholder:"编码"},model:{value:t.dataForm.cd,callback:function(e){t.$set(t.dataForm,"cd",e)},expression:"dataForm.cd"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:20}},[r("el-form-item",{attrs:{label:"名称",prop:"nm"}},[r("el-input",{attrs:{placeholder:"名称"},model:{value:t.dataForm.nm,callback:function(e){t.$set(t.dataForm,"nm",e)},expression:"dataForm.nm"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:20}},[r("el-form-item",{attrs:{label:"备注",prop:"rmks"}},[r("el-input",{attrs:{placeholder:"备注"},model:{value:t.dataForm.rmks,callback:function(e){t.$set(t.dataForm,"rmks",e)},expression:"dataForm.rmks"}})],1)],1)],1),t._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:14}},[r("el-form-item",{attrs:{label:"资源授权",size:"mini"}},[r("el-tree",{ref:"rscoListTree",attrs:{data:t.rscoList,props:{label:"nm",children:"children"},"node-key":"id","show-checkbox":""}})],1)],1)],1)],1),t._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取消")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dataFormSubmit()}}},[t._v("确定")])],1)],1)},staticRenderFns:[]};var d=r("VU/8")(l,c,!1,function(t){r("fzvG")},null,null);e.default=d.exports},fzvG:function(t,e,r){var s=r("yfKG");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);r("rjj0")("6f5ec699",s,!0)},yfKG:function(t,e,r){(t.exports=r("FZ+f")(!1)).push([t.i,"\n.mod-role-edit .el-dialog{\r\n  width: 45%\n}\r\n",""])}});