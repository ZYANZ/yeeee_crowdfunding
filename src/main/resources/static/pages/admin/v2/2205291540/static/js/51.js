webpackJsonp([51,8,19],{"1gWN":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Dd8w"),n=a.n(i),r=a("O4Lo"),l={data:function(){var t=this;return{id:null,pid:null,pnm:null,pcd:null,visible:!1,otherParamsVisible:!1,catListVisible:!1,catList:[],dataForm:{id:"",code:"",name:"",pnm:"",pid:null,tid:null,sort:0,busSeq:0,rmks:"",arg1:"",arg2:"",arg3:"",arg4:"",arg5:""},dataFormOrigin:{},dataRule:{code:[{required:!0,message:"编码不能为空",trigger:"blur"},{validator:function(e,a,i){var n=t.$query.new();t.$query.toW(n,e.field,a,"EQ"),t.$http.get("/admin/sys-cat/exist?query="+encodeURIComponent(t.$query.toJsonStr(n))).then(function(n){var r=n.data;200!==r.code&&i(new Error("服务器异常,校验失败")),a!==t.dataFormOrigin[e.field]&&r.data?i(new Error("已被使用")):i()}).catch(function(){i(new Error("校验失败"))})},trigger:"blur"}],name:[{required:!0,message:"名称不能为空",trigger:"blur"}]}}},methods:{init:function(t){var e=this;this.dataForm.id=null,this.dataFormOrigin={},this.id=t,this.visible=!0,this.$nextTick(function(){e.$refs.dataForm.resetFields(),e.dataForm.tid=e.pid,e.dataForm.pnm=e.pnm,e.listCat().then(function(){e.id&&e.getInfo()})})},listCat:function(){var t=this,e=this.$query.new();return this.$query.toW(e,"tid",this.pid,"EQ"),this.$http.get("/admin/sys-cat/item-tree?query="+encodeURIComponent(this.$query.toJsonStr(e))).then(function(e){var a=e.data;if(200!==a.code)return t.$message.error(a.message);t.catList=a.data.result}).catch(function(){})},getInfo:function(){var t=this;this.$http.json().post("/admin/sys-cat/info",{id:this.id}).then(function(e){var a=e.data;if(200!==a.code)return t.$message.error(a.message);t.dataForm=n()({},t.dataForm,a.data),t.dataFormOrigin=n()({},t.dataFormOrigin,a.data)}).catch(function(){})},catListTreeCurrentChangeHandle:function(t){this.dataForm.pid=t.id,this.dataForm.pnm=t.name,this.dataForm.code=t.code+".",this.catListVisible=!1},catListTreeSetDefaultHandle:function(){this.dataForm.pid=this.pid,this.dataForm.pnm=this.pnm,this.dataForm.cd=this.pcd+"."},dataFormSubmit:a.n(r)()(function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){var a=t.id?"/admin/sys-cat/upd":"/admin/sys-cat/add";t.$http.post(a,n()({},t.dataForm)).then(function(e){var a=e.data;a&&200===a.code?t.$message({message:"操作成功",type:"success",duration:500,onClose:function(){t.visible=!1,t.$emit("refreshDataList")}}):t.$message.error(a.message)})}})},1e3,{leading:!0,trailing:!1})}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"mod-catItm-edit",attrs:{title:t.id?"修改":"新增","close-on-click-modal":!1,visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[a("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataRule,"label-width":"120px"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.dataFormSubmit()}}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{staticClass:"cat-list",attrs:{prop:"pid",label:"父级"}},[a("el-popover",{ref:"catListPopover",attrs:{placement:"bottom-start",trigger:"click"},model:{value:t.catListVisible,callback:function(e){t.catListVisible=e},expression:"catListVisible"}},[a("el-tree",{ref:"catListTree",attrs:{data:t.catList,props:{label:"name",children:"children"},"node-key":"id","highlight-current":!0,"expand-on-click-node":!1,accordion:""},on:{"current-change":t.catListTreeCurrentChangeHandle}})],1),t._v(" "),a("el-input",{directives:[{name:"popover",rawName:"v-popover:catListPopover",arg:"catListPopover"}],attrs:{readonly:!0,placeholder:t.dataForm.pnm},model:{value:t.dataForm.pnm,callback:function(e){t.$set(t.dataForm,"pnm",e)},expression:"dataForm.pnm"}},[t.dataForm.pid?a("i",{staticClass:"el-icon-circle-close el-input__icon",attrs:{slot:"suffix"},on:{click:function(e){e.stopPropagation(),t.catListTreeSetDefaultHandle()}},slot:"suffix"}):t._e()])],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"编码",prop:"code"}},[a("el-input",{attrs:{placeholder:"编码"},model:{value:t.dataForm.code,callback:function(e){t.$set(t.dataForm,"code",e)},expression:"dataForm.code"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"名称"},model:{value:t.dataForm.name,callback:function(e){t.$set(t.dataForm,"name",e)},expression:"dataForm.name"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"显示排序",prop:"sort"}},[a("el-input-number",{attrs:{min:1,max:1e5,label:"显示排序"},model:{value:t.dataForm.sort,callback:function(e){t.$set(t.dataForm,"sort",e)},expression:"dataForm.sort"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{placeholder:"备注"},model:{value:t.dataForm.remark,callback:function(e){t.$set(t.dataForm,"remark",e)},expression:"dataForm.remark"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"input-bar",attrs:{label:"更多参数"}},[a("i",{directives:[{name:"show",rawName:"v-show",value:!t.otherParamsVisible,expression:"!otherParamsVisible"}],staticClass:"el-icon-circle-plus-outline",on:{click:function(e){t.otherParamsVisible=!0}}}),t._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:t.otherParamsVisible,expression:"otherParamsVisible"}],staticClass:"el-icon-remove-outline",on:{click:function(e){t.otherParamsVisible=!1}}})])],1)],1),t._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.otherParamsVisible,expression:"otherParamsVisible"}],attrs:{gutter:20}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"参数1",prop:"arg1"}},[a("el-input",{attrs:{placeholder:"参数1"},model:{value:t.dataForm.arg1,callback:function(e){t.$set(t.dataForm,"arg1",e)},expression:"dataForm.arg1"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"参数2",prop:"arg2"}},[a("el-input",{attrs:{placeholder:"参数2"},model:{value:t.dataForm.arg2,callback:function(e){t.$set(t.dataForm,"arg2",e)},expression:"dataForm.arg2"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"参数3",prop:"arg3"}},[a("el-input",{attrs:{placeholder:"参数3"},model:{value:t.dataForm.arg3,callback:function(e){t.$set(t.dataForm,"arg3",e)},expression:"dataForm.arg3"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"参数4",prop:"arg4"}},[a("el-input",{attrs:{placeholder:"参数4"},model:{value:t.dataForm.arg4,callback:function(e){t.$set(t.dataForm,"arg4",e)},expression:"dataForm.arg4"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"参数5",prop:"arg5"}},[a("el-input",{attrs:{placeholder:"参数5"},model:{value:t.dataForm.arg5,callback:function(e){t.$set(t.dataForm,"arg5",e)},expression:"dataForm.arg5"}})],1)],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dataFormSubmit()}}},[t._v("确定")])],1)],1)},staticRenderFns:[]};var s=a("VU/8")(l,o,!1,function(t){a("8hdN")},null,null);e.default=s.exports},"7+Dk":function(t,e,a){"use strict";var i=a("NGEn"),n=a.n(i),r={name:"table-tree-column",props:{prop:{type:String},treeKey:{type:String,default:"id"},parentKey:{type:String,default:"parentId"},levelKey:{type:String,default:"_level"},childKey:{type:String,default:"children"}},methods:{childStyles:function(t){return{"padding-left":(t[this.levelKey]>1?7*t[this.levelKey]:0)+"px"}},iconClasses:function(t){return[t._expanded?"el-icon-caret-bottom":"el-icon-caret-right"]},iconStyles:function(t){return{visibility:this.hasChild(t)?"visible":"hidden"}},hasChild:function(t){return n()(t[this.childKey])&&t[this.childKey].length>=1||!1},toggleHandle:function(t,e){var a=this;if(this.hasChild(e)){var i=this.$parent.store.states.data.slice(0);i[t]._expanded=!i[t]._expanded,i=i[t]._expanded?i.splice(0,t+1).concat(e[this.childKey]).concat(i):this.removeChildNode(i,e[this.treeKey]),this.$parent.store.commit("setData",i),this.$nextTick(function(){a.$parent.doLayout()})}},removeChildNode:function(t,e){var a=n()(e)?e:[e];if(e.length<=0)return t;for(var i=[],r=0;r<t.length;r++)-1!==a.indexOf(t[r][this.parentKey])&&-1===a.indexOf(t[r][this.treeKey])&&(i.push(t.splice(r,1)[0][this.treeKey]),r--);return this.removeChildNode(t,i)}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table-column",t._b({attrs:{prop:t.prop},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{style:t.childStyles(e.row),on:{click:function(a){a.preventDefault(),t.toggleHandle(e.$index,e.row)}}},[a("i",{class:t.iconClasses(e.row),style:t.iconStyles(e.row)}),t._v("\n      "+t._s(e.row[t.prop])+"\n    ")])]}}])},"el-table-column",t.$attrs,!1))},staticRenderFns:[]},o=a("VU/8")(r,l,!1,null,null,null);e.a=o.exports},"8hdN":function(t,e,a){var i=a("NGUZ");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("ffefbcda",i,!0)},NGUZ:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.mod-catItm .cat-list .el-input__inner,\n.mod-catItm .cat-list .el-input__suffix,\n.mod-catItm .icon-list .el-input__inner,\n.mod-catItm .icon-list .el-input__suffix {\n  cursor: pointer;\n}\n.mod-catItm-icon-popover {\n  width: 458px;\n  overflow: hidden;\n}\n.mod-catItm-icon-inner {\n  width: 478px;\n  max-height: 258px;\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.mod-catItm-icon-list {\n  width: 458px;\n  padding: 0;\n  margin: -8px 0 0 -8px;\n}\n.mod-catItm-icon-list > .el-button {\n    padding: 8px;\n    margin: 8px 0 0 8px;\n}\n.mod-catItm-icon-list > .el-button > span {\n      display: inline-block;\n      vertical-align: middle;\n      width: 18px;\n      height: 18px;\n      font-size: 18px;\n}\n.mod-catItm-edit .input-bar i {\n  padding-top: 6px;\n  font-size: 24px;\n  color: #3a8ee6;\n  -webkit-transition-property: color;\n  transition-property: color;\n  -webkit-transition-duration: 0.15s;\n          transition-duration: 0.15s;\n  -webkit-transition-timing-function: linear;\n          transition-timing-function: linear;\n  -webkit-transition-delay: initial;\n          transition-delay: initial;\n}\n",""])},z1E5:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("7+Dk"),n=a("1gWN"),r=a("H2tP"),l=a("qDAy"),o={mixins:[a("u7jc").a],data:function(){return{module:"/admin/sys-cat/",gridOptions:{isAct:!1,isQuery:!0,isPage:!1,listUrl:"/admin/sys-cat/item-tree"},pcd:"",pid:null,pnm:null,dataForm:{tid:null},dataMode:{tid:"EQ"}}},components:{tableTreeColumn:i.a,edit:n.default,info:r.default,impt:l.default},activated:function(){this.pid||(this.pid=this.$route.params.pid||0,this.pnm=this.$route.params.pnm||null,this.pcd=this.$route.params.pcd||"",this.dataForm.tid=this.pid),this.listData()},methods:{editHandle:function(t){var e=this;this.editVisible=!0,this.$nextTick(function(){e.$refs.edit.pid=e.pid,e.$refs.edit.pnm=e.pnm,e.$refs.edit.pcd=e.pcd,e.$refs.edit.init(t)})}}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod-catItm"},[a("el-form",{attrs:{inline:!0,model:t.dataForm},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.listData()}}},[a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.listData()}}},[t._v("查询")]),t._v(" "),t.$hasPerm("sys:cat:add")?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.editHandle()}}},[t._v("新增")]):t._e(),t._v(" "),t.$hasPerm("sys:cat:del")?a("el-button",{attrs:{size:"small",type:"danger",disabled:t.dataListSelections.length<=0},on:{click:function(e){t.delHandle()}}},[t._v("删除")]):t._e()],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.dataList,border:"",stripe:"","max-height":t.tableHeight},on:{"selection-change":t.selectionChangeHandle,"sort-change":t.sortChangeHandle}},[a("el-table-column",{attrs:{type:"selection","header-align":"center",align:"center",width:"50"}}),t._v(" "),a("table-tree-column",{attrs:{prop:"name",treeKey:"id",parentKey:"pid",levelKey:"level",childKey:"children",label:"名称","header-align":"center",align:"left"}}),t._v(" "),a("el-table-column",{attrs:{prop:"code",label:"编码","header-align":"center",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sort",label:"显示排序","header-align":"center",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right","header-align":"center",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.$hasPerm("sys:cat:info")?a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-document",title:"详情"},on:{click:function(a){t.infoHandle(e.row.id)}}}):t._e(),t._v(" "),t.$hasPerm("sys:cat:upd")?a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit",title:"编辑"},on:{click:function(a){t.editHandle(e.row.id)}}}):t._e(),t._v(" "),t.$hasPerm("sys:cat:del")?a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-delete",title:"删除"},on:{click:function(a){t.delHandle(e.row.id)}}}):t._e()]}}])})],1),t._v(" "),this.gridOptions.isPage?a("el-pagination",{attrs:{"current-page":t.pageNo,"page-sizes":t.pageSizes,"page-size":t.pageSize,total:t.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.sizeChangeHandle,"current-change":t.currentChangeHandle}}):t._e(),t._v(" "),t.editVisible?a("edit",{ref:"edit",on:{refreshDataList:t.listData}}):t._e(),t._v(" "),t.infoVisible?a("info",{ref:"info"}):t._e(),t._v(" "),t.imptVisible?a("impt",{ref:"impt",on:{refreshDataList:t.listData}}):t._e()],1)},staticRenderFns:[]},d=a("VU/8")(o,s,!1,null,null,null);e.default=d.exports}});